#!/usr/bin/env node

// Import the built CircuitPython module and run the CLI
async function main() {
    // Import the built module
    const circuitPython = await import('./build-standard/circuitpython.mjs');
    
    // Initialize CircuitPython first
    const cp = await circuitPython.loadCircuitPython();
    
    // Initialize REPL
    cp.replInit();
    
    console.log('CircuitPython REPL initialized successfully!');
    console.log('Available methods:', Object.keys(cp));
    
    // Test basic functionality
    console.log('\n--- Testing Python execution ---');
    
    try {
        console.log('Running: print("Hello from CircuitPython!")');
        await cp.runPython('print("Hello from CircuitPython!")');
        
        console.log('Running: import sys; print(f"Python version: {sys.version}")');
        await cp.runPython('import sys; print(f"Python version: {sys.version}")');
        
        console.log('Running: import math; print(f"Square root of 16: {math.sqrt(16)}")');
        await cp.runPython('import math; print(f"Square root of 16: {math.sqrt(16)}")');
        
    } catch (error) {
        console.log('Test error:', error.message);
    }
    
    console.log('\nðŸŽ‰ CircuitPython WebAssembly is working!');
}

main().catch(console.error);